
{
  "entities": {
    "SharedMap": {
      "title": "Shared Map State",
      "description": "Represents the serializable state of a map view for sharing.",
      "type": "object",
      "properties": {
        "layers": {
          "type": "array",
          "description": "List of active layers.",
          "items": {
            "type": "object",
            "properties": {
              "type": { "type": "string", "description": "Layer type (e.g., 'wfs', 'wms', 'gee', 'local')." },
              "name": { "type": "string", "description": "Display name of the layer." },
              "url": { "type": "string", "description": "The base URL of the OGC server." },
              "layerName": { "type": "string", "description": "The machine-readable layer name (e.g., 'workspace:layer')." },
              "opacity": { "type": "number", "description": "Layer opacity from 0 to 1." },
              "visible": { "type": "boolean", "description": "Layer visibility." },
              "wmsStyleEnabled": { "type": "boolean", "description": "Whether the WMS style is active." },
              "styleName": { "type": "string", "description": "The original WMS style name." },
              "geeParams": {
                "type": "object",
                "description": "Parameters for GEE layers.",
                 "properties": {
                    "bandCombination": { "type": "string" },
                    "tileUrl": { "type": "string" }
                 }
              }
            },
            "required": ["type", "name"]
          }
        },
        "view": {
          "type": "object",
          "description": "Map view state.",
          "properties": {
            "center": { "type": "array", "items": { "type": "number" }, "description": "Map center in [lon, lat]." },
            "zoom": { "type": "number", "description": "Map zoom level." }
          },
          "required": ["center", "zoom"]
        },
        "baseLayerId": {
          "type": "string",
          "description": "The ID of the active base layer."
        },
        "createdAt": {
          "type": "string",
          "description": "Timestamp of when the map was shared. This will be a server timestamp object."
        }
      },
      "required": ["layers", "view", "baseLayerId", "createdAt"]
    }
  },
  "auth": {
    "providers": []
  },
  "firestore": {
    "rules": "firestore.rules",
    "/sharedMaps/{mapId}": {
        "schema": { "$ref": "#/entities/SharedMap" },
        "description": "Stores the state of shared maps. Anyone can read/create."
    }
  }
}
