
{
  "entities": {
    "SharedMap": {
      "title": "Shared Map State",
      "description": "Represents the serializable state of a map view for sharing.",
      "type": "object",
      "properties": {
        "subject": {
          "type": "string",
          "description": "The user-defined subject or title of the shared map."
        },
        "layers": {
          "type": "array",
          "description": "List of active layers.",
          "items": {
            "type": "object",
            "properties": {
              "type": { "type": "string", "description": "Layer type (e.g., 'wfs', 'wms', 'gee', 'local')." },
              "name": { "type": "string", "description": "Display name of the layer." },
              "url": { "type": "string", "description": "The base URL of the OGC server." },
              "layerName": { "type": "string", "description": "The machine-readable layer name (e.g., 'workspace:layer')." },
              "opacity": { "type": "number", "description": "Layer opacity from 0 to 1." },
              "visible": { "type": "boolean", "description": "Layer visibility." },
              "wmsStyleEnabled": { "type": "boolean", "description": "Whether the WMS style is active." },
              "styleName": { "type": "string", "description": "The original WMS style name." },
              "geeParams": {
                "type": "object",
                "description": "Parameters for GEE layers.",
                 "properties": {
                    "bandCombination": { "type": "string" },
                    "tileUrl": { "type": "string" }
                 }
              }
            },
            "required": ["type", "name"]
          }
        },
        "view": {
          "type": "object",
          "description": "Map view state.",
          "properties": {
            "center": { "type": "array", "items": { "type": "number" }, "description": "Map center in [lon, lat]." },
            "zoom": { "type": "number", "description": "Map zoom level." }
          },
          "required": ["center", "zoom"]
        },
        "baseLayerId": {
          "type": "string",
          "description": "The ID of the active base layer."
        },
        "createdAt": {
          "type": "string",
          "description": "Timestamp of when the map was shared. This will be a server timestamp object."
        }
      },
      "required": ["subject", "layers", "view", "baseLayerId", "createdAt"]
    },
    "Agent": {
      "title": "Agent Profile",
      "description": "Represents a player in the Cartodea deployment game.",
      "type": "object",
      "properties": {
        "nickname": { "type": "string", "description": "The agent's display name." },
        "current_cd": { "type": "number", "description": "Deployment Capacity available." },
        "deployment_center": { "type": "object", "description": "GeoPoint of the agent's base." },
        "is_deploying": { "type": "boolean", "description": "Flag if the agent is in transit." },
        "upgrades": { "type": "object", "description": "Object storing agent's upgrades." }
      },
      "required": ["nickname", "current_cd", "deployment_center", "is_deploying"]
    },
    "Incident": {
      "title": "Game Incident",
      "description": "Represents an active incident in the game.",
      "type": "object",
      "properties": {
        "location": { "type": "object", "description": "GeoPoint of the incident." },
        "type": { "type": "string", "enum": ["Inundación", "Fuego Urbano", "Fuego Rural"], "description": "The type of incident." },
        "urgency_level": { "type": "string", "enum": ["Bajo", "Medio", "Crítico"], "description": "Urgency of the incident." },
        "operational_resilience": { "type": "number", "description": "Resource that depletes over time." },
        "is_resolved": { "type": "boolean", "description": "Flag if the incident is resolved." },
        "createdAt": { "type": "string", "description": "Timestamp of incident creation." }
      },
      "required": ["location", "type", "urgency_level", "operational_resilience", "is_resolved", "createdAt"]
    }
  },
  "auth": {
    "providers": ["google.com"]
  },
  "firestore": {
    "/sharedMaps/{mapId}": {
      "schema": { "$ref": "#/entities/SharedMap" },
      "description": "Stores shared map configurations."
    },
    "/agents/{agentId}": {
      "schema": { "$ref": "#/entities/Agent" },
      "description": "Stores agent profiles for the game."
    },
    "/incidents/{incidentId}": {
      "schema": { "$ref": "#/entities/Incident" },
      "description": "Stores active game incidents."
    }
  }
}
